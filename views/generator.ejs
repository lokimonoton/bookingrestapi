<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Traveler</title>


	<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
	<link rel="stylesheet" href="assets/materialize/css/materialize.min.css" media="screen,projection" />
    <!-- Bootstrap Styles-->
    <link href="assets/css/bootstrap.css" rel="stylesheet" />
    <!-- FontAwesome Styles-->
    <link href="assets/css/font-awesome.css" rel="stylesheet" />
    <!-- Morris Chart Styles-->
    <link href="assets/js/morris/morris-0.4.3.min.css" rel="stylesheet" />
    <!-- Custom Styles-->
    <link href="assets/css/custom-styles.css" rel="stylesheet" />
    <link href="https://cdn.datatables.net/1.10.7/css/jquery.dataTables.min.css" rel="stylesheet"/>
    <!-- Google Fonts-->
    <link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css' />
    <link rel="stylesheet" href="assets/js/Lightweight-Chart/cssCharts.css">
<link href="assets/materialize.clockpicker.css" rel="stylesheet">
</head>
<body>
    <div id="wrapper">
        <nav class="navbar navbar-default top-navbar" role="navigation">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".sidebar-collapse">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand waves-effect waves-dark" href="/"><i class="large material-icons">insert_chart</i> <strong>TRAVEL</strong></a>

		<div id="sideNav" href=""><i class="material-icons dp48">toc</i></div>
            </div>

            <ul class="nav navbar-top-links navbar-right">
				<li><a class="dropdown-button waves-effect waves-dark" href="#!" data-activates="dropdown4"><i class="fa fa-envelope fa-fw"></i> <i class="material-icons right">arrow_drop_down</i></a></li>
				<li><a class="dropdown-button waves-effect waves-dark" href="#!" data-activates="dropdown3"><i class="fa fa-tasks fa-fw"></i> <i class="material-icons right">arrow_drop_down</i></a></li>
				<li><a class="dropdown-button waves-effect waves-dark" href="#!" data-activates="dropdown2"><i class="fa fa-bell fa-fw"></i> <i class="material-icons right">arrow_drop_down</i></a></li>
				  <li><a class="dropdown-button waves-effect waves-dark" href="#!" data-activates="dropdown1"><i class="fa fa-user fa-fw"></i> <b>John Doe</b> <i class="material-icons right">arrow_drop_down</i></a></li>
            </ul>
        </nav>
		<!-- Dropdown Structure -->
<ul id="dropdown1" class="dropdown-content">
<li><a href="#"><i class="fa fa-user fa-fw"></i> My Profile</a>
</li>
<li><a href="#"><i class="fa fa-gear fa-fw"></i> Settings</a>
</li>
<li><a href="#"><i class="fa fa-sign-out fa-fw"></i> Logout</a>
</li>
</ul>
<ul id="dropdown2" class="dropdown-content w250">
  <li>
                            <a href="#">
                                <div>
                                    <i class="fa fa-comment fa-fw"></i> New Comment
                                    <span class="pull-right text-muted small">4 min</span>
                                </div>
                            </a>
                        </li>
                        <li class="divider"></li>
                        <li>
                            <a href="#">
                                <div>
                                    <i class="fa fa-twitter fa-fw"></i> 3 New Followers
                                    <span class="pull-right text-muted small">12 min</span>
                                </div>
                            </a>
                        </li>
                        <li class="divider"></li>
                        <li>
                            <a href="#">
                                <div>
                                    <i class="fa fa-envelope fa-fw"></i> Message Sent
                                    <span class="pull-right text-muted small">4 min</span>
                                </div>
                            </a>
                        </li>
                        <li class="divider"></li>
                        <li>
                            <a href="#">
                                <div>
                                    <i class="fa fa-tasks fa-fw"></i> New Task
                                    <span class="pull-right text-muted small">4 min</span>
                                </div>
                            </a>
                        </li>
                        <li class="divider"></li>
                        <li>
                            <a href="#">
                                <div>
                                    <i class="fa fa-upload fa-fw"></i> Server Rebooted
                                    <span class="pull-right text-muted small">4 min</span>
                                </div>
                            </a>
                        </li>
                        <li class="divider"></li>
                        <li>
                            <a class="text-center" href="#">
                                <strong>See All Alerts</strong>
                                <i class="fa fa-angle-right"></i>
                            </a>
                        </li>
</ul>
<ul id="dropdown3" class="dropdown-content dropdown-tasks w250">
<li>
		<a href="#">
			<div>
				<p>
					<strong>Task 1</strong>
					<span class="pull-right text-muted">60% Complete</span>
				</p>
				<div class="progress progress-striped active">
					<div class="progress-bar progress-bar-success" role="progressbar" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100" style="width: 60%">
						<span class="sr-only">60% Complete (success)</span>
					</div>
				</div>
			</div>
		</a>
	</li>
	<li class="divider"></li>
	<li>
		<a href="#">
			<div>
				<p>
					<strong>Task 2</strong>
					<span class="pull-right text-muted">28% Complete</span>
				</p>
				<div class="progress progress-striped active">
					<div class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="28" aria-valuemin="0" aria-valuemax="100" style="width: 28%">
						<span class="sr-only">28% Complete</span>
					</div>
				</div>
			</div>
		</a>
	</li>
	<li class="divider"></li>
	<li>
		<a href="#">
			<div>
				<p>
					<strong>Task 3</strong>
					<span class="pull-right text-muted">60% Complete</span>
				</p>
				<div class="progress progress-striped active">
					<div class="progress-bar progress-bar-warning" role="progressbar" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100" style="width: 60%">
						<span class="sr-only">60% Complete (warning)</span>
					</div>
				</div>
			</div>
		</a>
	</li>
	<li class="divider"></li>
	<li>
		<a href="#">
			<div>
				<p>
					<strong>Task 4</strong>
					<span class="pull-right text-muted">85% Complete</span>
				</p>
				<div class="progress progress-striped active">
					<div class="progress-bar progress-bar-danger" role="progressbar" aria-valuenow="85" aria-valuemin="0" aria-valuemax="100" style="width: 85%">
						<span class="sr-only">85% Complete (danger)</span>
					</div>
				</div>
			</div>
		</a>
	</li>
	<li class="divider"></li>
	<li>
</ul>
<ul id="dropdown4" class="dropdown-content dropdown-tasks w250">
  <li>
                            <a href="#">
                                <div>
                                    <strong>John Doe</strong>
                                    <span class="pull-right text-muted">
                                        <em>Today</em>
                                    </span>
                                </div>
                                <div>Lorem Ipsum has been the industry's standard dummy text ever since the 1500s...</div>
                            </a>
                        </li>
                        <li class="divider"></li>
                        <li>
                            <a href="#">
                                <div>
                                    <strong>John Smith</strong>
                                    <span class="pull-right text-muted">
                                        <em>Yesterday</em>
                                    </span>
                                </div>
                                <div>Lorem Ipsum has been the industry's standard dummy text ever since an kwilnw...</div>
                            </a>
                        </li>
                        <li class="divider"></li>
                        <li>
                            <a href="#">
                                <div>
                                    <strong>John Smith</strong>
                                    <span class="pull-right text-muted">
                                        <em>Yesterday</em>
                                    </span>
                                </div>
                                <div>Lorem Ipsum has been the industry's standard dummy text ever since the...</div>
                            </a>
                        </li>
                        <li class="divider"></li>
                        <li>
                            <a class="text-center" href="#">
                                <strong>Read All Messages</strong>
                                <i class="fa fa-angle-right"></i>
                            </a>
                        </li>
</ul>
	   <!--/. NAV TOP  -->
        <!--/. NAV TOP  -->
        <nav class="navbar-default navbar-side" role="navigation">
            <div class="sidebar-collapse">
                <ul class="nav" id="main-menu">
                    <li>
                        <a href="/" class="waves-effect waves-dark"><i class="fa fa-fw fa-file"></i> Booking.json</a>
                    </li>
                    <li>
                        <a href="/flight" class="waves-effect waves-dark"><i class="fa fa-fw fa-file"></i> Flight.json</a>
                    </li>
                    <li>
                        <a href="/traveler" class="waves-effect waves-dark"><i class="fa fa-fw fa-file"></i> Traveler.json</a>
                    </li>
                </ul>

            </div>

        </nav>
        <!-- /. NAV SIDE  -->
        <div id="page-wrapper" ng-app="myModule">
		  <div class="header">
                        <h1 class="page-header">
                            Tables Page
                        </h1>
						<ol class="breadcrumb">
					  <li><a href="#">Home</a></li>
					  <li><a href="#">Tables</a></li>
					  <li class="active">Data</li>
					</ol>

		</div>

            <div id="page-inner" ng-controller="MyCtrl">
<a class="waves-effect waves-light btn" href="/">Back</a>
<br><br>fill all that has "*" sign
        <div class="row">
                <div class="col-md-12">
                    <!-- Advanced Tables -->
                    <div class="card">
                        <div class="card-action">
Booking details
                        </div>
                        <div class="card-content">
<div class="row">
        <div class="input-field col s12">
          <label for="disabled">BOOKING ID{auto generated}</label>
          <input disabled style="color:black;" value="<%=id_booking+1%>" id="disabled" type="text" class="validate">

        </div>
      </div>
      <div class="row">
      <div class="input-field col s12">
          <label for="disabled">DATE*</label>
       <input type="text" class="datepicker">

        </div>

      </div>
      <div class="row">
      <div class="input-field col s12">
          <label for="disabled">COST*</label>
       <input type="number" >

        </div>

      </div>
      <div class="row">
        <div class="input-field col s12">
          <label for="disabled">MILES(auto generated)</label>
          <input disabled style="color:black;" id="miles" value="0" id="disabled" type="text" class="validate">

        </div>
      </div>

                        </div>
                    </div>
                    <!--End Advanced Tables -->
                </div>
            </div>
            <div class="row">
                <div class="col-md-12">
                    <!-- Advanced Tables -->
                    <div class="card">
                        <div class="card-action">
Traveler details
                        </div>
                        <div class="card-content">

<div class="row">
        <div class="input-field col s12">
          <label for="disabled">ID(auto generated)</label>
          <input disabled style="color:black;" value="<%=id_traveler+1%>" id="disabled" type="text" class="validate">

        </div>
      </div>
      <div class="row">
      <div class="input-field col s12">
          <label for="disabled">Firstname*</label>
       <input type="text" >

        </div>

      </div>
      <div class="row">
      <div class="input-field col s12">
          <label for="disabled">Lastname*</label>
       <input type="text" >

        </div>

      </div>
      <div class="row">
      <div class="input-field col s12">
          <label for="disabled">BIRTH DATE*</label>
       <input type="text" class="datepicker">

        </div>

      </div>
      <div class="row">
      <div class="input-field col s12">
          <label for="disabled">Passport Number*</label>
       <input type="text" >

        </div>

      </div>
      <div class="row">
           <div class="input-field col s12">
    <label>Passport Country Code*</label>
    <input type="text" >

  </div>
      </div>
      <div class="row">
      <div class="input-field col s12">
          <label for="disabled">PASSPORT EXPIRY DATE*</label>
       <input type="text" class="datepicker">

        </div>

      </div>
      <div class="row">
      <div class="input-field col s12">
          <label for="disabled">Loyality Number*</label>
       <input type="text" >

        </div>

      </div>
                        </div>
                    </div>
                    <!--End Advanced Tables -->
                </div>
            </div>
            <div class="row">
                <div class="col-md-12">
                    <!-- Advanced Tables -->
                    <div class="card">
                        <div class="card-action">
Flight Details
                        </div>
                        <div class="card-content">

  <div class="row">
        <div class="input-field col s12">
          <label for="disabled">ID(auto generated)</label>
          <input disabled style="color:black;" value="<%=id_flight+1%>" id="disabled" type="text" class="validate">

        </div>
      </div>
      <div class="row">
      <div class="input-field col s12">
          <label for="disabled">CODE*</label>
       <input type="text" >

        </div>

      </div>
      <div class="row">
      <div class="input-field col s12">
          <label for="disabled">Miles*</label>
       <input type="number" >

        </div>

      </div>
      <div class="row">
      <div class="input-field col s12">
          <label for="disabled">DEPARTURE AIRPORT CODE*</label>
       <input type="text" >

        </div>

      </div>
      <div class="row">
      <div class="input-field col s12">
          <label for="disabled">DEPARTURE DATE*</label>
       <input type="text" class="datepicker">

        </div>

      </div>
      <div class="row">
      <div class="input-field col s12">
          <label for="disabled">DEPARTURE TIME*</label>
       <input type="text" class="timepicker">

        </div>

      </div>
      <div class="row">
      <div class="input-field col s12">
          <label for="disabled">ARRIVAL AIRPORT CODE*</label>
       <input type="text" >

        </div>

      </div>
      <div class="row">
      <div class="input-field col s12">
          <label for="disabled">ARRIVAL DATE*</label>
       <input type="text" class="datepicker">

        </div>

      </div>
      <div class="row">
      <div class="input-field col s12">
          <label for="disabled">ARRIVAL TIME*</label>
       <input type="text" class="timepicker">

        </div>

      </div>
<a class="waves-effect waves-light btn" ng-click="addFlightDetail()">ADD FLIGHT DETAIL</a>
    <br><br>
    <div class="table-responsive">
                                <table class="table table-striped table-bordered table-hover"  >
                                    <thead>

                                            <th ng-repeat="(key,value) in flightDetail[0]">{{key}}</th>


                                    </thead>
                                    <tbody>

                                        <tr ng-repeat="flight in flightDetail">

                                            <td ng-repeat="(key,value) in flight">{{value}}</td>
                                            <td><a class="waves-effect waves-light btn" ng-click="delete($index)">Delete</a></td>
                                        </tr>




                                    </tbody>
                                </table>
                            </div>

                        </div>
                    </div>
                    <!--End Advanced Tables -->
                </div>
            </div>
                               <footer><a class="waves-effect waves-light btn" ng-click="save()" >Save</a></footer>
    </div>
             <!-- /. PAGE INNER  -->
            </div>
         <!-- /. PAGE WRAPPER  -->
     <!-- /. WRAPPER  -->
    <!-- JS Scripts-->

<script src="assets/jquery.min.js"></script>
<script src="assets/jquery.dataTables.min.js"></script>
<script src="assets/angular.min.js"></script>
<script src="assets/angular-datatables.min.js"></script>
    <!-- jQuery Js -->
    <!--<script src="assets/js/jquery-1.10.2.js"></script>-->

	<!-- Bootstrap Js -->
    <script src="assets/js/bootstrap.min.js"></script>

	<script src="assets/materialize/js/materialize.min.js"></script>

    <!-- Metis Menu Js -->
    <script src="assets/js/jquery.metisMenu.js"></script>
    <!-- Morris Chart Js -->
    <script src="assets/js/morris/raphael-2.1.0.min.js"></script>
    <script src="assets/js/morris/morris.js"></script>
<script src="assets/moment.min.js"></script>

	<script src="assets/js/easypiechart.js"></script>
	<script src="assets/js/easypiechart-data.js"></script>
<script src="assets/materialize.clockpicker.js"></script>
	 <script src="assets/js/Lightweight-Chart/jquery.chart.js"></script>
	 <!-- DATA TABLE SCRIPTS -->
    <!--<script src="assets/js/dataTables/jquery.dataTables.js"></script>-->
    <!--<script src="assets/js/dataTables/dataTables.bootstrap.js"></script>-->
        <script>
        $('.datepicker').pickadate({
    selectMonths: true, // Creates a dropdown to control month
    selectYears: 15, // Creates a dropdown of 15 years to control year,
    today: 'Today',
    clear: 'Clear',
    close: 'Ok',
    closeOnSelect: false // Close upon selecting a date,
  });
  $('.timepicker').pickatime({
    default: 'now', // Set default time: 'now', '1:30AM', '16:30'
    fromnow: 0,       // set default time to * milliseconds from now (using with default = 'now')
    twelvehour: false, // Use AM/PM or 24-hour format
    donetext: 'OK', // text for done-button
    cleartext: 'Clear', // text for clear-button
    canceltext: 'Cancel', // Text for cancel-button
    autoclose: false, // automatic close timepicker
    ampmclickable: true, // make AM PM clickable
    aftershow: function(){} //Function for after opening timepicker
  });

            angular.module('myModule', ['datatables'])
.controller("MyCtrl", function($scope,$http, DTOptionsBuilder)
{
    $scope.bookings = [];
$scope.flightDetail=[]
$scope.addFlightDetail=function(){
    const kosong=$(".card-content").eq(2).children("div.row").children("div").children("input")
var sudah=[]
for(var i=0;i<kosong.length;i++){
if(kosong.eq(i).val()==""){
kosong.eq(i).attr("class","invalid")
}else{
    sudah.push(kosong.eq(i).val())
}
}
if(sudah.length==9){
var faik={}
faik.id=Number(sudah[0])
faik.code=sudah[1]
faik.miles=Number(sudah[2])
faik.depAirportCode=sudah[3]
faik.depDate=sudah[4]
faik.depTime=sudah[5]
faik.arrAirportCode=sudah[6]
faik.arrDate=sudah[7]
faik.arrTime=sudah[8]
$("#miles").val(Number($("#miles").val())+Number(sudah[2]))
$scope.flightDetail.push(faik)
kosong.attr("class","")
kosong.eq(0).val(Number(kosong.eq(0).val())+1)
for(let i=1;i<kosong.length;i++){
    kosong.eq(i).val("")
}
}else{
    alert("please fill all the blank")
}
}

$scope.delete=function(index){
    $("#miles").val(Number($("#miles").val())-Number($scope.flightDetail[index].miles))
    $scope.flightDetail.splice(index,1)
    // console.log(index)
}
$scope.save=function(){
     const kosong=$(".card-content").eq(1).children("div.row").children("div").children("input")
     const kosong1=$(".card-content").eq(0).children("div.row").children("div").children("input")
var travel=[]
var booking=[]
var sudah=[]
var sudah1=[]
for(var i=0;i<kosong.length;i++){
if(kosong.eq(i).val()==""){
kosong.eq(i).attr("class","invalid")
}else{
    sudah.push(kosong.eq(i).val())
}
}
for(var i=0;i<kosong1.length;i++){
if(kosong1.eq(i).val()==""){
kosong1.eq(i).attr("class","invalid")
}else{
    sudah1.push(kosong1.eq(i).val())
}
}
if(sudah1.length==4&&sudah.length==8&&$scope.flightDetail.length!=0){
let sementara={}
sementara.id=Number(sudah[0])
sementara.firstName=sudah[1]
sementara.lastName=sudah[2]
sementara.birthDate=sudah[3]
sementara.passportNumber=sudah[4]
sementara.passportCountryCode=sudah[5]
sementara.passportExpiryDate=sudah[6]
sementara.loyalityNumber=sudah[7]
travel.push(sementara)
let sementara1={}
sementara1.id=Number(sudah1[0])
sementara1.date=sudah1[1]
sementara1.cost=Number(sudah1[2])
sementara1.miles=Number(sudah1[3])
sementara1.travelerId=sementara.id
sementara1.flightIds=[]
$scope.flightDetail.forEach(fly=>{
sementara1.flightIds.push(fly.id)
})
booking.push(sementara1)
$http.post("/createBooking",{booking:booking,traveler:travel,flight:$scope.flightDetail}).then(data=>{
kosong.attr("class","")
kosong1.attr("class","")
    kosong.eq(0).val(Number(kosong.eq(0).val())+1)
    kosong1.eq(0).val(Number(kosong1.eq(0).val())+1)
for(let i=1;i<kosong.length;i++){
    kosong.eq(i).val("")
}
for(let i=1;i<kosong1.length;i++){
    kosong1.eq(i).val("")
}
$scope.flightDetail=[]
$("#miles").val("0")
console.log({booking:booking,traveler:travel,flight:$scope.flightDetail})

alert("success save to .json file you can add more booking")

})


}else{
    alert("please fill all the blank and dont forget to add at least one flight detail data")
}

}
    // DataTables configurable options
    $scope.dtOptions = DTOptionsBuilder.newOptions()
        .withDisplayLength(10)
        .withOption('bLengthChange', false);


});
    </script>
    <!-- Custom Js -->
    <script src="assets/js/custom-scripts.js"></script>


</body>

</html>
